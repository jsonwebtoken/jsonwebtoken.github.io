function url_base64_decode(a){var b=a.replace("-","+").replace("_","/");switch(b.length%4){case 0:break;case 2:b+="==";break;case 3:b+="=";break;default:throw"Illegal base64url string!"}return window.atob(b)}CodeMirror.defineMode("jwt",function(){function a(a,c){return a.eatWhile(/[^.]/),c.cur=b,"jwt-header"}function b(a,b){return a.next(),b.cur=c,"jwt-dot"}function c(a,b){return a.eatWhile(/[^.]/),b.cur=d,"jwt-payload"}function d(a,b){return a.next(),b.cur=e,"jwt-dot"}function e(a){return a.skipToEnd(),"jwt-signature"}return{token:function(a,b){var c=b.cur;return c(a,b)},startState:function(){return{cur:a}}}}),window.hextorstr=function(a){return window.CryptoJS.enc.Hex.parse(a)},window.decode=function(a){var b=null,c=null;try{b=url_base64_decode(a),b=JSON.stringify(JSON.parse(b),void 0,2)}catch(d){c=d}return{result:b,error:c}},window.sign=function(a,b,c,d){var e,f,g="",h=null;try{e=JSON.stringify(JSON.parse(a))}catch(i){h={result:null,error:{cause:i,who:["header"]}}}try{f=JSON.stringify(JSON.parse(b))}catch(i){h?h.error.who.push("payload"):h={result:null,error:{cause:i,who:["payload"]}}}if(h)return h;if(d)try{c=window.b64utob64(c),c=window.CryptoJS.enc.Base64.parse(c).toString()}catch(i){return{result:"",error:i}}else c=window.CryptoJS.enc.Latin1.parse(c).toString();try{g=KJUR.jws.JWS.sign(null,e,f,c)}catch(i){h=i}return{result:g,error:h}},window.isValidBase64String=function(a){try{return a=window.b64utob64(a),window.CryptoJS.enc.Base64.parse(a).toString(),!0}catch(b){return!1}},window.verify=function(a,b,c){var d="",e=null;if(c)try{b=window.b64utob64(b),b=window.CryptoJS.enc.Base64.parse(b).toString()}catch(f){return{result:"",error:f}}else b=window.CryptoJS.enc.Latin1.parse(b).toString();try{d=KJUR.jws.JWS.verify(a,b)}catch(f){e=f}return{result:d,error:e}},function(){function a(a){var b;document.createEvent?(b=document.createEvent("HTMLEvents"),b.initEvent("change",!0,!0)):(b=document.createEventObject(),b.eventType="change"),b.eventName="change",document.createEvent?a.dispatchEvent(b):a.fireEvent("on"+b.eventType,b)}function b(a){a.replaceSelection("   ","end")}function c(a,b,c){a.off("change",g),a.setValue(null!==b.result&&void 0!==b.result?b.result:""),b.error?c.addClass("error"):c.removeClass("error"),a.on("change",g)}function d(b){var d=i(b);if(d){var e=d.split("."),f=document.getElementsByName("secret")[0],g=h("js-signature");if(g){var j=window.decode(e[0]),k=$(".jwt-header");c(m,j,k);var l=window.decode(e[1]);k=$(".jwt-payload"),c(n,l,k),a(f)}}}function e(a){localStorage.jwtValue=a}function f(a){a(localStorage.jwtValue),localStorage.clear()}function g(){l.off("change",d);var b=document.getElementsByName("secret")[0],c=document.getElementsByName("is-base64-encoded")[0],f=window.sign(m.getValue(),n.getValue(),b.value,c.checked);if(f.error){l.setValue("");var g={payload:".jwt-payload",header:".jwt-header"};$(".jwt-payload").removeClass("error"),$(".jwt-header").removeClass("error"),f.error.who&&f.error.who.map(function(a){return g[a]}).forEach(function(a){$(a).addClass("error")}),$(".input").addClass("error"),l.setValue(f.result?f.result:"")}else l.setValue(f.result),$(".input").removeClass("error"),$(".jwt-payload").removeClass("error"),$(".jwt-header").removeClass("error"),e(f.result);l.on("change",d),a(b)}function h(a){var b=document.getElementsByClassName(a);return b.length?b[0]:null}function i(a){var b=a.getValue();return b?b.replace(/\s/g,""):null}function j(){var a=h("js-signature"),b=h("jwt-signature");if(a){var c=i(l),d=p.checked;if(d&&!window.isValidBase64String(o.value))return void $(b).addClass("error");$(b).removeClass("error");var e=window.verify(c,o.value,d),f=e.error;e=e.result,!f&&e?($(a).removeClass("invalid-token"),$(a).addClass("valid-token"),a.innerHTML='<i class="fa fa-check-circle-o"></i> signature verified'):($(a).removeClass("valid-token"),$(a).addClass("invalid-token"),a.innerHTML='<i class="fa fa-times-circle-o"></i> invalid signature')}}var k=CodeMirror,l=k(document.getElementsByClassName("js-input")[0],{mode:"jwt",theme:"night",lineWrapping:!0,autofocus:!0,extraKeys:{Tab:b}}),m=k(document.getElementsByClassName("js-header")[0],{mode:"application/json",lineWrapping:!0,extraKeys:{Tab:b},lint:!0}),n=k(document.getElementsByClassName("js-payload")[0],{mode:"application/json",lineWrapping:!0,extraKeys:{Tab:b},lint:!0});l.on("change",d),n.on("change",g),m.on("change",g);var o=document.getElementsByName("secret")[0],p=document.getElementsByName("is-base64-encoded")[0];o.addEventListener("change",j,!1),o.addEventListener("keyup",j,!1),p.addEventListener("change",j,!1),f(function(a){l.setValue(a||"eyJhbGciOiJIUzI1NiIsImN0eSI6IkpXVCJ9.eyJzdWIiOjEyMzQ1Njc4OTAsIm5hbWUiOiJKb2huIERvZSIsImFkbWluIjp0cnVlfQ.Qb8vkCubb6B4vTn2jsmQcsUTej7XB5abeIY9sUXfU0A")})}();